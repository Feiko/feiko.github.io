



<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#" lang="en">
<head>
    <title>Feiko.IO - Adding Netlify CMS to your .NET powered static Website</title>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Feiko Gorter">
    <meta property="og:site_name" content="Feiko.IO">
    <meta name="application-name" content="Feiko.IO" />
    <meta name="msapplication-tooltip" content="Feiko.IO" />
    <meta name="msapplication-starturl" content="http://feiko.io/" />

    <meta name="twitter:site" content="@feikogorter">
    <meta name="twitter:creator" content="@feikogorter">
    <meta name="twitter:title" content="Feiko.IO - Adding Netlify CMS to your .NET powered static Website">
    <meta property="og:title" content="Feiko.IO - Adding Netlify CMS to your .NET powered static Website" />

            <meta property='og:description' content="Create an .net powered website for free using Github Pages, Statiq.web and Netlify CMS - Part II" />
            <meta name="description" content="Create an .net powered website for free using Github Pages, Statiq.web and Netlify CMS - Part II">
            <meta name="twitter:description" content="Create an .net powered website for free using Github Pages, Statiq.web and Netlify CMS - Part II">
            <meta name="twitter:card" content="summary_large_image">
            <meta property="og:url" content="http://feiko.io/posts/2021-05-07-adding-netlify-cms-to-your-net-powered-static-website" />
            <meta name="twitter:card" content="summary_large_image">
            <meta name="twitter:image" content="http://feiko.io/images/netlify-cms-example.png">
            <meta property="og:image" content="http://feiko.io/images/netlify-cms-example.png" />
            <meta property="og:type" content="article" />
            <meta name="publish_date" property="og:article:published_time" content="05/07/2021 16:53" />
            <meta name="author" property="og:article:author" content="Feiko Gorter" />
            <meta property="og:section" content="Technology" />
                <meta property="og:article:tag" content="Blog" />
                <meta property="og:article:tag" content="Web" />
                <meta property="og:article:tag" content=".NET" />
                <meta property="og:article:tag" content="CMS" />

    <link rel="shortcut icon" href="/favicon.ico">

    <!-- FontAwesome JS-->
    <script defer src=/fontawesome/js/all.min.js></script>

    <!-- Theme CSS -->
    <link id="theme-style" rel="stylesheet" href=/css/theme-5.css>
    <link id="theme-style" rel="stylesheet" href=/css/site.css>

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/monokai-sublime.min.css">

</head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LY52GT5EFK"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'GA_MEASUREMENT_ID');
</script>
<body>

    <!-- Page Header -->
    



<header class="header text-center">
    <h1 class="blog-name d-inline-flex pt-lg-4"><a href="/">Feiko.IO</a></h1>

    <nav class="navbar navbar-expand-lg navbar-dark">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>


        <div id="navigation" class="collapse navbar-collapse flex-column">
            <div class="profile-section pt-3 pt-lg-0">
                <img class="profile-image mb-3 rounded-circle mx-auto" src="/images/feiko-gorter.png" alt="image">

                <div class="bio mb-3">
                    <p>Hi, I'm Feiko Gorter, an IoT specialist, inventor, speaker, dyslexic and .net geek. Welcome to my personal site about everything IoT and Tech.</p>

                </div><!--//bio-->
                        <ul class="social-list list-inline py-3 mx-auto">
                                <li class="list-inline-item"><a href="https://www.linkedin.com/in/feikogorter"><i class="fab fa-linkedin fa-fw"></i></a></li>
                                <li class="list-inline-item"><a href="https://github.com/feiko"><i class="fab fa-github fa-fw"></i></a></li>
                                <li class="list-inline-item"><a href="https://www.youtube.com/channel/UCBX8mmVnL-juQWjOPwZSrTQ"><i class="fab fa-youtube fa-fw"></i></a></li>
                                <li class="list-inline-item"><a href="https://twitter.com/feikogorter"><i class="fab fa-twitter fa-fw"></i></a></li>
                        </ul><!--//social-list-->


                <ul class="navbar-nav flex-column text-left">
                    <li class="nav-item ">
                        <a class="nav-link" href="/"><i class="fas fa-home fa-fw mr-2"></i>Home <span class="sr-only">(current)</span></a>
                    </li>
                            <li class="nav-item  ">
                                <a class="nav-link" href="/about-me"><i class="fas fa-user fa-fw mr-2"></i>About Me</a>
                            </li>
                    <li class="nav-item ">
                        <a class="nav-link" href="/tags"><i class="fas fa-tags fa-fw mr-2"></i>Tags </a>
                    </li>

                </ul>

                <hr>

                        <div>
                            <h5>Tags</h5>
                                <a href="/tags/blog" class="badge badge-primary"> Blog (2)</a>
                                <a href="/tags/web" class="badge badge-primary"> Web (2)</a>
                                <a href="/tags/net" class="badge badge-primary"> .NET (1)</a>
                                <a href="/tags/cms" class="badge badge-primary"> CMS (1)</a>
                                <a href="/tags/static" class="badge badge-primary"> Static (1)</a>
                                <a href="/tags/tutorial" class="badge badge-primary"> Tutorial (1)</a>
                                <a href="/tags/dotnet" class="badge badge-primary"> Dotnet (1)</a>
                            <div class="my-2 my-md-3">
                                <a class="btn btn-primary" href="/tags" role="button">All Tags <i class="fas fa-angle-double-right"></i></a>
                            </div>
                        </div>

            </div>
    </nav>
</header>




    <div class="main-wrapper">
        <div class="content-wrapper d-flex flex-column min-vh-100">

                <article class="blog-post px-3 py-5 p-md-5">
                    <div class="container">
                        




<header class="blog-post-header">
    <h2 class="title mb-2">Adding Netlify CMS to your .NET powered static Website</h2>
    <h3 class="meta mb-2">The ideal blog website for .NET developers - Part II</h3>
    <div class="meta mb-3"><span class="date">Friday, 07 May 2021</span><span class="time">8 min read</span></div>
</header>
<div class="blog-post-body">
        <figure class="blog-banner">
            <img class="img-fluid" src="/images/netlify-cms-example.png" alt="image">
        </figure>
    </div>




   
                        <p>This is part II of the series about creating your own .NET powered static website. Here you can find part I: <a href="https://www.feiko.io/posts/2021-04-30-create-your-own-net-powered-website-for-free">Create your own .net powered static website for FREE</a></p>
<p>In this tutorial we are going to use NetlifyCMS. Netlify CMS is a flat-file headless CMS. Flat-file means that content is saved to simple files rather than using a database like SQL or MongoDB. In our case, these are Markdown files. A headless CMS is a Content Management System that is completely detached and unaware of any backend systems used to generate your website. This differs completely from the systems we know from the ASP.NET world. A traditional CMS like Umbraco is completely built on top of ASP.NET MVC and uses a SQL database. The content management and public website are very much intertwined and done by the same hosting platform.</p>
<p>Flat-file and headless CMS systems are ideal for managing content of simple websites. These systems are usually very nimble and easy to set up.</p>
<p><strong>At the end of this tutorial you will have:</strong></p>
<ul>
<li>A repository running your actual clean static public GitHub Page</li>
<li>A second private repository running your .NET site-generator/backend that you build in Part I</li>
<li>The Netlify CMS that uses Netlify to update your markdown content on GitHub</li>
<li>A GitHub Actions attached to your site generator that will automatically update your website</li>
</ul>
<p>Let’s get started and pick up where we left off in Part I. You can also look into my <a href="https://github.com/Feiko/StaticBlogExample">example repo</a> on my GitHub.
<br />
 
<br />
 </p>
<h3 id="step-1-adding-the-netlify-cms-and-github-repos"><strong>Step 1 -</strong> Adding the Netlify CMS and GitHub repos</h3>
<p><br />
 </p>
<p>We start by adding Netlify CMS so we can add and manage our content in a friendly manner. Open the project you created in Part I and create an <em>admin</em> directory inside the <em>input</em> directory. In this directory we create an <em>index.html</em> file with the following magic Netlify CMS code:</p>
<pre><code class="language-html">ShouldOutput: true
---
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
  &lt;title&gt;Content Manager&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;!-- Include the script that builds the page and powers Netlify CMS --&gt;
  &lt;script src=&quot;https://unpkg.com/netlify-cms&#64;^2.0.0/dist/netlify-cms.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Now we are going to push our code to a new GitHub repo on your GitHub. We can easily do this in the latest version of VS2019 using ‘Git Changes’. Make sure you give your repository a meaningful name like ‘MyWebSiteGenerator’. Please don’t tell me you don’t have a GitHub account!!! Shame on you, you call yourself a developer 😜 ???</p>
<figure>
  <img src="/images/create-github-repo-with-vs2019.png" alt="Create GitHub Repo using VS2019" class="img-fluid" title="Create GitHub Repo using VS2019" />
</figure>
<p><br />
 
<br />
 </p>
<h3 id="step-2-registering-your-github-page"><strong>Step 2 -</strong> Registering your GitHub Page</h3>
<p><br />
 </p>
<p>Now your code is in GitHub we will have to add some magic to hook up the NetlifyCMS. For this we first need to set up a Netlify site (we are not going to use this site… complicated I know. And, ‘Yes I wish there was a better way…’)</p>
<p>But first, now we are in GitHub, let’s do some plumbing for our GitHub page. Create a new public repository on your GitHub and name this repository &lt;YourGithubName&gt;.github.io. This will also be the domain where your website is hosted. Next we need to hook up your code to automatically deploy to this GitHub Page. Go inside the newly created Page repo and go to the ‘Settings’ tap and select 'Pages'. Press ‘Choose a theme’ and select the first theme and press ‘Select theme’. This will generate a branch called ‘gh-pages’ where the selected theme will deploy. Don’t worry we are going to overwrite this default theme with our own awesome static website.</p>
<p>If you know go to the ‘Pages’ section in your repo ‘Settings’, you should see in green ‘Your site is published at https://&lt;YourGithubName&gt;.github.io/’. If it says published at https://&lt;YourGithubName&gt;.github.io/&lt;RepoName&gt;/’ then you did not name your repo correctly &lt;YourGithubName&gt;.github.io. This will not work because the blog site expects to be published inside the root of your website domain!
<br />
 
<br />
 </p>
<h3 id="step-3-setup-netlify-cms"><strong>Step 3 -</strong> Setup Netlify CMS</h3>
<p><br />
 </p>
<p>To set up Netlify CMS follow the first two steps ‘creating an GitHub OAuth App’ and ‘Creating a Netlify Site’ from the following <a href="https://cnly.github.io/2018/04/14/just-3-steps-adding-netlify-cms-to-existing-github-pages-site-within-10-minutes.html">great blog</a>.</p>
<p>Now we can add the <em>config.yml</em> to <em>/input/admin</em> directory inside your code. This is the heart of the Netlify CMS. You can download my <em>config.yml</em> from my <a href="https://github.com/Feiko/StaticBlogExample/blob/master/input/admin/config.yml">GitHub Repo</a>. I’ve gone ahead and configured this <em>config.yml</em> file for you. You only have to change the backend settings inside the <em>config.yml</em> to target the GitHub Repo where your site generator lives (so not your GitHub Pages Repo). So change ‘repo:  &lt;GitHubName&gt;/&lt;RepoName&gt;‘  i.e.  feiko/StaticBlogExample. Also change the site domain 'site_domain'  to the &lt;SiteName&gt;.netlify.app  you just created when configuring Netlify. If you use a different branch then ‘master’ please also change this setting.</p>
<p>Go ahead and git commit and push this <em>config.yml</em> to GitHub. Now you can preview the site locally using the <code>dotnet run -- preview</code> command (see Part I) and browse to ‘localhost:5080/admin’. You should be able to log into your CMS using your GitHub credentials.</p>
<p>Now you can write a blog or page in the CMS. Netlify will automatically commit your new content to your remote GitHub repo. To preview the changes locally, you need to ‘git pull’ the content from your remote repo. Run the preview site and enjoy your freshly written blog… locally…</p>
<p><em><strong>Note:</strong></em></p>
<p>Don’t forget to commit and push your local changes to GitHub. You can also add the /output folder to the .gitignore file so you don’t keep pushing and pulling these changes.</p>
<p><em><strong>Note:</strong></em></p>
<p>If the admin page is displayed malformed mixed with CleanBlog theme elements. Then we need to tell Statiq to ignore the <em>admin</em> directory. If everything looks okay, then ignore this step.</p>
<p>To tell Statiq to ignore the <em>/input/admin</em> directory you can insert the following code to <em>program.cs</em> after ‘.CreateWeb(args)’.</p>
<pre><code class="language-csharp">.AddSetting(WebKeys.ExcludedPaths,
            	new List&lt;NormalizedPath&gt;
            	{
                	new NormalizedPath(&quot;input/admin&quot;),
            	})
</code></pre>
<p><br />
 
<br />
 </p>
<h3 id="step-4-deploy-your-site-to-github-pages"><strong>Step 4 -</strong>Deploy your site to GitHub Pages</h3>
<p><br />
 </p>
<p>Finally we come to the magic Sauce. We are going to host our site on our GitHub Page and use GitHub Actions to update your website automatically every time you commit a change in your CMS or on your GitHub repo.</p>
<p>First we are going to generate a token to allow Github Action to update your GitHub Pages. For this login into GitHub.com. In the top right click on your icon and in the drop-down menu select ‘Settings’. Now select ‘Developer Settings’ and then select ‘Personal access tokens’. Click ‘Generate new token’. Give the token a recognizable name in ‘Note’ i.e. ‘Page Token’, then <strong>only</strong> check ‘public_repo’ under ‘Select scopes’, at the bottom click the green ‘Generate token’ button. Copy the generated token to a temp document for later use.</p>
<p>Now we tell Statiq where to deploy or website, by adding the following code to Program.cs, after ‘.CreateWeb(args)</p>
<pre><code class="language-csharp">.DeployToGitHubPagesBranch(
            	&quot;&lt;githubName in my case: feiko&gt;&quot;,
            	&quot;&lt;RepoName Github Pages, in my case: feiko.github.io &gt;&quot;,
                Environment.GetEnvironmentVariable(&quot;GITHUB_TOKEN&quot;),
            	&quot;&lt;the branch name that holds the page content, in my case: gh-pages&gt;&quot;
            	)
</code></pre>
<p>My complete program.cs looks like this:</p>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Threading.Tasks;
using Statiq.App;
using Statiq.Common;
using Statiq.Web;
 
namespace StaticBlogExample
{
	public class Program
	{
    	public static async Task&lt;int&gt; Main(string[] args) =&gt;
        	await Bootstrapper
        	.Factory
        	.CreateWeb(args)
        	.DeployToGitHubPagesBranch(
            	&quot;feiko&quot;,
            	&quot;feiko.github.io&quot;,
                Environment.GetEnvironmentVariable(&quot;PAGE_TOKEN&quot;),
            	&quot;gh-pages&quot;
            	)
        	.AddSetting(WebKeys.ExcludedPaths,
            	new List&lt;NormalizedPath&gt;
            	{
                	new NormalizedPath(&quot;input/admin&quot;),
            	})
 
        	.RunAsync();
	}
}
</code></pre>
<p>You can optionally test this code by changing the  ‘Environment.GetEnvironmentVariable(&quot;PAGE_TOKEN&quot;)’, to the token string you copied earlier. Now run <code>dotnet run -- deploy</code>. Your content should now be visible inside your GitHub pages repo and you can visit your static website at ‘https://&lt;YourGithubName&gt;.github.io/’. It can take a couple of minutes for GitHub to start hosting your site the first time.</p>
<p><strong>Never</strong> commit your GitHub token to GitHub. So be sure to change this line back after you’ve finished. If you have published your token by accident, your token will no longer work and you have to renew your token.*</p>
<p>Now make sure you commit and push your code to GitHub for the last time.
<br />
 
<br />
 </p>
<h3 id="step-5-automatic-deployment-using-github-actions"><strong>Step 5 -</strong> Automatic deployment using GitHub Actions</h3>
<p><br />
 </p>
<p>The last step is to create a GitHub Action that will run the website generator every time you update your website using your CMS or checking in some new code.</p>
<p>Go to GitHub and open the Repo with your site generator code (not your GitHub Page repo). Open the tab ‘Actions’ and click ‘set up a workflow yourself -&gt;’.</p>
<p>Replace the code inside the editor with the following script:</p>
<pre><code class="language-csharp">name: Publish GitHub_Page

on:
  push:
    branches: [ master ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout&#64;v2
    - name: Setup .NET
      uses: actions/setup-dotnet&#64;v1
      with:
        dotnet-version: 5.0.x
    - run: dotnet run -- deploy
      env:
        PAGE_TOKEN: ${{ secrets.PAGE_TOKEN }}
</code></pre>
<p>Then press the green ‘start commit’ button. Finally we need to generate an authorization token that will allow Actions to deploy to GitHub Pages. Go to the ‘settings’ tap of your site-generator-repo and in your left menu select ‘Secrets’ to create a secret for your GitHub commit token. Click ‘New repository secret’. Name this secret ‘PAGE_TOKEN', inside the ‘Value’ paste the token you generated earlier. Now press ‘Add secret’ and voila your token is stored securely inside your GitHub Repo.</p>
<p>To kick off the action and deploy your site the first time you need to make a Git commit to your website. The easiest way to do this is by creating a readme.md inside the root of your site generator repo in Github. This commit will kick off the action. You can see your action status in the GitHub ‘action’ tab. After your Action has run successfully, you see your static blog at https://&lt;YourGithubName&gt;.github.io/. From now on all changes you make inside your CMS https://&lt;YourGithubName&gt;.github.io/admin/, will be committed to the GitHub websiteGenerator repo. This will kick off the action and update your website. </p>
<p>And now you're <strong>done</strong>! Congratulations, how cool! You see, now all .NET geeks can blog like Scott Hanselman! I can’t wait for you to share your knowledge with the world.</p>
<p>If you want to create a more special website like myself, you can create your own theme or reuse a theme you already have. Be sure to check out the documentation on <a href="https://statiq.dev/web/">https://statiq.dev/web/</a>, also look at the documentation of Netlify CMS on <a href="https://www.netlifycms.org/docs/configuration-options/">how to configure your config.yml file</a>. Happy coding!
<br />
 
<br />
 </p>
<h3 id="conclusion"><strong>Conclusion</strong></h3>
<p><br />
 </p>
<p>Having a .NET powered static page generator made my life a lot easier. I was able to reuse a lot of my old ASP.NET knowledge when creating my own web theme. Setting up Netlify CMS together with a Netlify account can feel a bit circumstantial. But having a CMS experience makes adding content a lot easier. Because we have used a flat-file headless CMS we can easily switch from the CMS system. Perhaps in the future we would have a CMS built using .NET Blazor, that would be really awesome! </p>
<p>Please let me know if you found this blog helpful or have any questions. Happy coding!</p>





                    </div><!--//container-->
                </article>
                <div class="container">
                    <div class="row">
                        <div class="col-md-12 d-flex justify-content-center">
                            <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
                                <a class="a2a_button_twitter"></a>
                                <a class="a2a_button_linkedin"></a>
                                <a class="a2a_button_facebook"></a>
                                <a class="a2a_button_whatsapp"></a>
                                <a class="a2a_button_email"></a>
                                <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
                            </div>
                            <script async src="https://static.addtoany.com/menu/page.js"></script>
                        </div>
                    </div>
                </div>
                <div class="containter">
                    <div class="px-3 py-5 p-md-5">

                        <script src="https://utteranc.es/client.js"
                                repo="feiko/feiko.github.io"
                                issue-term="title"
                                theme="github-light"
                                crossorigin="anonymous"
                                async>
                        </script>

                    </div>
                </div>
                <br />
                <br />

            <!-- subfooter section -->
            <div class="container">
                <div class="row">
                    <div class="col-md-12 text-center">
                        <p class="copyright text-muted m-0">Copyright &#xA9; 2021</p>
                        <br />
                        <ul class="list-inline text-center small">
                                <li class="list-inline-item">
                                    <a href="/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
                                </li>
                                <li class="list-inline-item">
                                    <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                                </li>
                        </ul>
                        <br />

                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        


<footer>
    
    <div class="footer text-center py-2 theme-bg-dark">

        <!--/* This template is free as long as you keep the footer attribution link. If you'd like to use the template without the attribution link, you can buy the commercial license via our website: themes.3rdwavemedia.com Thank you for your support. :) */-->
        <small class="copyright">Designed with <i class="fas fa-heart" style="color: #fb866a;"></i> by <a href="http://themes.3rdwavemedia.com" target="_blank">Xiaoying Riley</a> for developers</small>

    </div>
</footer>

    </div><!--//main-wrapper-->
    <!-- Javascript -->
    <script src=/plugins/jquery-3.4.1.min.js></script>
    <script src=/plugins/popper.min.js></script>
    <script src=/plugins/bootstrap/js/bootstrap.min.js></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>

    <script src=/js/blog.js></script>



</body>
</html> 